{% extends 'gestionOfertas/base.html' %}
{% load static %}
{% load widget_tweaks %} 

{% block title %}Registro - MatchJob{% endblock %}

{% block content %}
<div class="container my-5">
    <div class="row justify-content-center">
        <div class="col-md-10 col-lg-8">
            <div class="card shadow-lg rounded-4">
                <div class="card-header bg-primary text-white text-center rounded-top-4">
                    <h2 class="my-2"><i class="bi bi-person-plus-fill"></i> Crear una cuenta</h2>
                </div>
                <div class="card-body p-4">
                    <form method="post" novalidate>
                        {% csrf_token %}

                        <div class="mb-3">
                            <label for="id_tipo_usuario" class="form-label">Tipo de Usuario</label>
                            {{ form.tipo_usuario|add_class:"form-select" }}
                        </div>

                        <!-- Persona -->
                        <div id="persona-fields" class="user-type-fields" style="display: none;">
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="id_nombres" class="form-label">Nombres</label>
                                    {{ form.nombres|add_class:"form-control" }}
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="id_apellidos" class="form-label">Apellidos</label>
                                    {{ form.apellidos|add_class:"form-control" }}
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="id_fecha_nacimiento" class="form-label">Fecha de Nacimiento</label>
                                    {{ form.fecha_nacimiento|add_class:"form-control" }}
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="id_nacionalidad" class="form-label">Nacionalidad</label>
                                    {{ form.nacionalidad|add_class:"form-control" }}
                                </div>
                            </div>
                        </div>

                        <!-- Empresa -->
                        <div id="empresa-fields" class="user-type-fields" style="display: none;">
                            <div class="mb-3">
                                <label for="id_nombre_empresa" class="form-label">Nombre de la Empresa</label>
                                {{ form.nombre_empresa|add_class:"form-control" }}
                            </div>
                            <div class="mb-3">
                                <label for="id_rut_empresa" class="form-label">RUT de la Empresa</label>
                                {{ form.rut_empresa|add_class:"form-control" }}
                            </div>
                            <div class="mb-3">
                                <label for="id_razon_social" class="form-label">Razón Social</label>
                                {{ form.razon_social|add_class:"form-control" }}
                            </div>
                            <div class="mb-3">
                                <label for="id_giro" class="form-label">Giro Comercial</label>
                                {{ form.giro|add_class:"form-control" }}
                            </div>
                        </div>

                        <!-- Campos comunes -->
                        <div class="mb-3">
                            <label for="id_username" class="form-label">RUT</label>
                            {{ form.username|add_class:"form-control" }}
                        </div>

                        <div class="mb-3">
                            <label for="id_correo" class="form-label">Correo electrónico</label>
                            {{ form.correo|add_class:"form-control" }}
                        </div>

                        <div class="mb-3">
                            <label for="id_telefono" class="form-label">Teléfono</label>
                            {{ form.telefono|add_class:"form-control" }}
                        </div>

                        <div class="mb-4">
                            <label for="id_password" class="form-label">Contraseña</label>
                            {{ form.password|add_class:"form-control" }}
                        </div>

                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="bi bi-person-check-fill me-1"></i> Crear cuenta
                            </button>
                        </div>
                    </form>
                </div>
                <div class="card-footer text-center py-3">
                    ¿Ya tienes cuenta? <a href="{% url 'iniciar_sesion' %}" class="text-decoration-none">Inicia sesión aquí</a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block js %}
<script>
    function toggleUsuarioFields() {
        const tipoUsuario = document.getElementById('id_tipo_usuario').value;
        const personaFields = document.getElementById('persona-fields');
        const empresaFields = document.getElementById('empresa-fields');

        personaFields.style.display = tipoUsuario === 'persona' ? 'block' : 'none';
        empresaFields.style.display = tipoUsuario === 'empresa' ? 'block' : 'none';
    }

    window.onload = () => {
        toggleUsuarioFields();
        document.getElementById('id_tipo_usuario').addEventListener('change', toggleUsuarioFields);
    };
</script>
{% endblock %}
